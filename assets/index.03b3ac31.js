import{s as e,d as a,r as t,w as l,c as n,a as o,F as i,b as r,e as s,f as u,g as c,h as d,P as p,T as m}from"./vendor.b4ae6030.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&a(e)})).observe(document,{childList:!0,subtree:!0})}function a(e){if(e.ep)return;e.ep=!0;const a=function(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerpolicy&&(a.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?a.credentials="include":"anonymous"===e.crossorigin?a.credentials="omit":a.credentials="same-origin",a}(e);fetch(e.href,a)}}();var v="_canvas-container_1mwm5_1";const h=e(),f=e(),g=a((()=>{const e=t();return l(f,(()=>{var a;e.value&&(f.value?(e.value.width=f.value.width,e.value.height=f.value.height,null==(a=e.value.getContext("2d"))||a.putImageData(f.value,0,0)):(e.value.width=0,e.value.height=0))}),{immediate:!1}),()=>n("div",{class:v},[n("canvas",{ref:e},null)])}));var b="_filter-panel_1vxbl_1",y="_actions_1vxbl_8",w="_filter-list_1vxbl_17",_="_filter_1vxbl_1",N="_psnr_1vxbl_23";function x(e,a){return a.reduce(((e,a)=>a(e)),e)}function C(e,a){return a.displayName=e,a}function k(e,a){return document.createElement("canvas").getContext("2d").createImageData(e,a)}function P(e,a){const t=a.length,l=Math.floor(t/2),{data:n,height:o,width:i}=e;return L(e,((e,r)=>{let s=0,u=0,c=0;for(let d=0;d<t;d++)for(let p=0;p<t;p++){const t=r+d-l,m=e+p-l;if(t>=0&&t<o&&m>=0&&m<i){const e=a[d][p],l=4*(t*i+m);s+=n[l]*e,u+=n[l+1]*e,c+=n[l+2]*e}}return[s,u,c]}))}function L({width:e,height:a},t){const l=k(e,a);for(let n=0;n<a;n++)for(let a=0;a<e;a++){const[o,i,r]=t(a,n),s=4*(n*e+a);l.data[s]=o,l.data[s+1]=i,l.data[s+2]=r,l.data[s+3]=255}return l}function E(e,a=3){return Array.from({length:a}).map((()=>Array(a).fill(e)))}function I(e){let a=0;return e.forEach((e=>e.forEach((e=>a+=e)))),function(e,a){return e.map((e=>e.map((e=>e*a))))}(e,1/a)}function M(e){const a=e.length;return e.sort(),a%2==0?(e[a/2-1]+e[a/2])/2:e[Math.floor(a/2)]}const R=I(E(1)),S=C("Mean",(e=>P(e,R))),A=I([[1,2,1],[2,4,2],[1,2,1]]),D=C("Gaussian",(e=>P(e,A))),F=C("Median",(e=>{const{data:a,height:t,width:l}=e;return L(e,((e,n)=>{const o=[],i=[],r=[];for(let s=0;s<3;s++)for(let u=0;u<3;u++){const c=n+s-1,d=e+u-1;if(c>=0&&c<t&&d>=0&&d<l){const e=4*(c*l+d);o.push(a[e]),i.push(a[e+1]),r.push(a[e+2])}}return[M(o),M(i),M(r)]}))})),O=[[0,-1,0],[-1,4,-1],[0,-1,0]],T=C("Laplacian",(e=>P(e,O))),j=[[0,-.2,0],[-.2,1.8,-.2],[0,-.2,0]],U=C("Sharpen",(e=>P(e,j))),$=I(E(1/9)),q=C("Low Pass",(e=>P(e,$))),G=[[-1,-1,-1],[-1,8,-1],[-1,-1,-1]],H=C("High Pass",(e=>P(e,G))),K=[[1/4,0,-1/4],[.5,0,-.5],[1/4,0,-1/4]],z=[[1/4,.5,1/4],[0,0,0],[-1/4,-.5,-1/4]],B=C("Sobel",(e=>function(e,a){const t=e.data,l=a.data,n=t.length,o=k(e.width,e.height);for(let i=0;i<n;i++){const e=t[i]+l[i];o.data[i]=e>255?255:e}return o}(P(e,K),P(e,z))));function J(){const e=(a="image/*",()=>new Promise((e=>{const t=document.createElement("input");t.type="file",a&&(t.accept=a),t.onchange=()=>{if(!t.files)return;const a=Array.from(t.files);e(a[0])},t.click()})));var a;return()=>new Promise((a=>{e().then((e=>{const t=new Image;t.onload=()=>{const e=document.createElement("canvas");e.width=t.width,e.height=t.height;const l=e.getContext("2d");l.drawImage(t,0,0),a(l.getImageData(0,0,t.width,t.height))},t.src=URL.createObjectURL(e)}))}))}function Q(e,a){const{width:t,height:l,data:n}=e,{data:o}=a,i=e.data.length;let r=0;for(let u=0;u<i;u++)r+=Math.pow(n[u]-o[u],2);const s=r/(t*l)/3;return 10*Math.log10(65025/s)}const V=a((()=>{const e=t(),a=a=>{var t;return null==(t=e.value)?void 0:t.toggle(a)},{psnr:l,busy:d,filters:p,handlePush:m,handleRemove:v,handleClear:g}=function(){const e=[],a=t(0),l=t(!1),n=t=>{e.push(t),f.value&&(l.value=!0,setTimeout((()=>{f.value=x(f.value,[t]),a.value=Q(h.value,f.value),l.value=!1}),0))},o=t=>{e.splice(t,1),0===e.length?i():f.value&&h.value&&(l.value=!0,setTimeout((()=>{f.value=x(h.value,e),a.value=Q(h.value,f.value),l.value=!1}),0))},i=()=>{e.length=0,f.value&&h.value&&(f.value=h.value),a.value=0};return{filters:e,handlePush:n,handleRemove:o,handleClear:i,busy:l,psnr:a}}(),C=[{label:"Smoothing",icon:"pi pi-external-link",items:[{label:S.displayName,command:()=>m(S)},{label:D.displayName,command:()=>m(D)},{label:F.displayName,command:()=>m(F)}]},{label:"Enhancement",icon:"pi pi-external-link",items:[{label:B.displayName,command:()=>m(B)},{label:H.displayName,command:()=>m(H)},{label:q.displayName,command:()=>m(q)},{label:T.displayName,command:()=>m(T)},{label:U.displayName,command:()=>m(U)}]}],k=J(),P=async()=>{f.value=h.value=await k()};return()=>n("div",{class:b},[n("div",null,[n("div",{class:`p-buttonset ${y}`},[n(o,{label:"Clear",class:"p-button-secondary p-button-outlined",icon:"pi pi-trash",onClick:g,disabled:!f.value||d.value},null),n(i,null,[n(o,{label:"Filters",icon:"pi pi-plus",class:"p-button-secondary","aria-haspopup":"true",onClick:a,disabled:!f.value||d.value},null),n(r,{ref:e,model:C,popup:!0},null)])]),n("div",{class:w},[p.map(((e,a)=>n("p",{class:_},[s(n(o,{label:e.displayName,class:"p-button-text p-button-plain",onClick:()=>v(a),disabled:d.value},null),[[u("tooltip"),`Remove ${e.displayName} Filter`]])]))).reverse()])]),n("div",null,[n("div",{class:N},[c("PSNR: "),l.value]),n("p",null,[n(o,{label:"Open Image",style:"width: 100%",icon:"pi pi-folder-open",class:"p-button",onClick:P,disabled:d.value},null)])])])}));d(a((()=>()=>n(i,null,[n("div",{class:"filter-panel"},[n(V,null,null)]),n("div",{class:"image-container"},[n(g,null,null)])])))).use(p).directive("tooltip",m).mount("#app");
